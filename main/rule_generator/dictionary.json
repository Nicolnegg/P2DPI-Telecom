{
  "zeus_js": {
    "groups": {
      "string": {
        "match_type": "14",
        "data_type": "string",
        "strings": [
          "var jsmLastMenu ",
          "position:absolute; z-index:99' ",
          " -1)jsmSetDisplayStyle('popupmenu' ",
          " '<tr><td><a href",
          "  jsmLastMenu ",
          "  var ids ",
          "this.target",
          " jsmPrevMenu, 'none');",
          "  if(jsmPrevMenu ",
          ")if(MenuData[i])",
          " '<div style",
          "popupmenu",
          "  jsmSetDisplayStyle('popupmenu' ",
          "function jsmHideLastMenu()",
          " MenuData.length; i"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "string"
        ],
        "operator": "and"
      }
    ]
  },
  "Email_Generic_Phishing": {
    "groups": {
      "eml_": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "From:",
          "To:",
          "Subject:"
        ]
      },
      "greeting_": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "Hello sir/madam",
          "Attention",
          "Dear user",
          "Account holder"
        ]
      },
      "url_": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "Click",
          "Confirm",
          "Verify",
          "Here",
          "Now",
          "Change password"
        ]
      },
      "lie_": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "Unauthorized",
          "Expired",
          "Deleted",
          "Suspended",
          "Revoked",
          "Unable"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "eml",
          "greeting",
          "url",
          "lie"
        ],
        "operator": "and"
      }
    ]
  },
  "extortion_email": {
    "groups": {
      "eml": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "From:",
          "To:",
          "Subject:"
        ]
      },
      "sub": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "Hackers know password from your account.",
          "Security Alert. Your accounts were hacked by a criminal group.",
          "Your account was under attack! Change your credentials!",
          "The decision to suspend your account. Waiting for payment",
          "Fraudsters know your old passwords. Access data must be changed.",
          "Your account has been hacked! You need to unlock it.",
          "Be sure to read this message! Your personal data is threatened!",
          "Password must be changed now."
        ]
      },
      "key": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "BTC",
          "Wallet",
          "Bitcoin",
          "hours",
          "payment",
          "malware",
          "bitcoin address",
          "access",
          "virus"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "eml",
          "sub",
          "key"
        ],
        "operator": "and"
      }
    ]
  },
  "Dridex_Trojan_XML": {
    "groups": {
      "c_xml": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<?xml version="
        ]
      },
      "c_word": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<?mso-application progid=\"Word.Document\"?>"
        ]
      },
      "c_macro": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "w:macrosPresent=\"yes\""
        ]
      },
      "c_binary": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<w:binData w:name="
        ]
      },
      "c_0_chars": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<o:Characters>0</o:Characters>"
        ]
      },
      "c_1_line": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<o:Lines>1</o:Lines>"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "c"
        ],
        "operator": "and"
      }
    ]
  },
  "PHISH_02Dez2015_dropped_p0o6543f": {
    "groups": {
      "s": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "netsh.exe",
          "routemon.exe",
          "script=",
          "disconnect",
          "GetClusterResourceTypeKey",
          "QueryInformationJobObject",
          "interface",
          "connect",
          "FreeConsole"
        ]
      },
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "4D 5A"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "s"
        ],
        "operator": "and"
      }
    ]
  },
  "PHISH_02Dez2015_attach_P_ORD_C_10156_124658": {
    "groups": {
      "s": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "Execute",
          "Process WriteParameterFiles",
          "WScript.Shell",
          "STOCKMASTER",
          "InsertEmailFax"
        ]
      },
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "D0 CF"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "s"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_version": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.0",
          "%PDF-1.1",
          "%PDF-1.2",
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "suspicious_creation": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "header": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.6"
        ]
      },
      "create": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "CreationDate (D:20101015142358)",
          "CreationDate (2008312053854)"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "header",
          "create"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_title": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "header": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.6"
        ]
      },
      "title": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "who cis",
          "P66N7FF",
          "Fohcirya"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "header",
          "title"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_author": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "header": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.6"
        ]
      },
      "author": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "Ubzg1QUbzuzgUbRjvcUb14RjUb1",
          "ser pes",
          "Miekiemoes",
          "Nsarkolke"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "header",
          "author"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_producer": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "header": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.6"
        ]
      },
      "producer": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "Producer (Scribus PDF Library",
          "Notepad"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "header",
          "producer"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_creator": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "header": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.6"
        ]
      },
      "creator": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "yen vaw",
          "Scribus",
          "Viraciregavi"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "header",
          "creator"
        ],
        "operator": "and"
      }
    ]
  },
  "possible_exploit": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "attrib": {
        "match_type": "2",
        "data_type": "string",
        "strings": [
          "/JavaScript ",
          "/ASCIIHexDecode",
          "/ASCII85Decode"
        ]
      },
      "action": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/Action",
          "Array"
        ]
      },
      "shell": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "AAAAAAAAAA"
        ]
      },
      "cond": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "unescape",
          "String.fromCharCode"
        ]
      },
      "nop": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "%u9090%u9090"
        ]
      }
    },
    "conditions": [
      {
        "or": [
          {
            "groups": [
              "magic",
              "attrib"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "action",
              "shell",
              "cond"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "action",
              "cond",
              "nop"
            ],
            "operator": "and"
          }
        ]
      }
    ]
  },
  "suspicious_js": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "attrib": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/OpenAction ",
          "/JavaScript "
        ]
      },
      "js": {
        "match_type": "2",
        "data_type": "string",
        "strings": [
          "eval",
          "Array",
          "String.fromCharCode"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "attrib",
          "js"
        ],
        "operator": "and"
      }
    ]
  },
  "suspicious_launch_action": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "attrib": {
        "match_type": "3",
        "data_type": "string",
        "strings": [
          "/Launch",
          "/URL ",
          "/Action",
          "/OpenAction",
          "/F "
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "attrib"
        ],
        "operator": "and"
      }
    ]
  },
  "invalid_XObject_js": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      },
      "attrib": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/XObject",
          "/JavaScript"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic",
              "attrib"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "multiple_versions": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "s": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "trailer",
          "%%EOF"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "s"
        ],
        "operator": "and"
      }
    ]
  },
  "js_wrong_version": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "js": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/JavaScript"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic",
              "js"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "JBIG2_wrong_version": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "js": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/JBIG2Decode"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic",
              "js"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "FlateDecode_wrong_version": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "js": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/FlateDecode"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.2",
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic",
              "js"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "embed_wrong_version": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "embed": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/EmbeddedFiles"
        ]
      },
      "ver": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "%PDF-1.3",
          "%PDF-1.4",
          "%PDF-1.5",
          "%PDF-1.6",
          "%PDF-1.7",
          "%PDF-1.8",
          "%PDF-1.9"
        ]
      }
    },
    "conditions": [
      {
        "and": [
          {
            "groups": [
              "magic",
              "embed"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "ver"
            ],
            "operator": "not"
          }
        ]
      }
    ]
  },
  "js_splitting": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "js": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "/JavaScript"
        ]
      },
      "s": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "getAnnots",
          "getPageNumWords",
          "getPageNthWord",
          "this.info"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "js",
          "s"
        ],
        "operator": "and"
      }
    ]
  },
  "BlackHole_v2": {
    "groups": {
      "magic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "content": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "Index[5 1 7 1 9 4 23 4 50"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "magic",
          "content"
        ],
        "operator": "and"
      }
    ]
  },
  "XDP_embedded_PDF": {
    "groups": {
      "s": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "<pdf xmlns=",
          "<chunk>",
          "</pdf>"
        ]
      },
      "header": {
        "match_type": "1",
        "data_type": "string",
        "strings": [
          "%PDF",
          "JVBERi0"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "s",
          "header"
        ],
        "operator": "and"
      }
    ]
  },
  "PDF_Embedded_Exe": {
    "groups": {
      "header": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "25 50 44 46"
        ]
      },
      "Launch_Action": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "3C 3C 2F 53 2F 4C 61 75 6E 63 68 2F 54 79 70 65 2F 41 63 74 69 6F 6E 2F 57 69 6E 3C 3C 2F 46"
        ]
      },
      "exe": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "3C 3C 2F 45 6D 62 65 64 64 65 64 46 69 6C 65 73"
        ]
      }
    },
    "conditions": [
      {
        "groups": [
          "header",
          "Launch_Action",
          "exe"
        ],
        "operator": "and"
      }
    ]
  },
  "Contains_VBA_macro_code": {
    "groups": {
      "officemagic": {
        "match_type": "all",
        "data_type": "hex",
        "strings": [
          "D0 CF 11 E0 A1 B1 1A E1"
        ]
      },
      "zipmagic": {
        "match_type": "all",
        "data_type": "string",
        "strings": [
          "PK"
        ]
      },
      "97str": {
        "match_type": "any",
        "data_type": "mixed",
        "strings": [
          {
            "value": "_VBA_PROJECT_CUR",
            "data_type": "string"
          },
          {
            "value": "VBAProject",
            "data_type": "string"
          },
          {
            "value": "41 74 74 72 69 62 75 74 00 65 20 56 42 5F",
            "data_type": "hex"
          }
        ]
      },
      "xmlstr": {
        "match_type": "any",
        "data_type": "string",
        "strings": [
          "vbaProject.bin",
          "vbaData.xml"
        ]
      }
    },
    "conditions": [
      {
        "or": [
          {
            "groups": [
              "officemagic",
              "97str"
            ],
            "operator": "and"
          },
          {
            "groups": [
              "zipmagic",
              "xmlstr"
            ],
            "operator": "and"
          }
        ]
      }
    ]
  },
  "webshell_ChinaChopper_aspx": {
    "groups": {
      "ChinaChopperASPX": {
        "match_type": "cadena",
        "data_type": "hex",
        "strings": [
          {
            "id": "ChinaChopperASPX_s0",
            "value": "25 40 20 50 61 67 65 20 4C 61 6E 67 75 61 67 65 3D"
          },
          {
            "id": "ChinaChopperASPX_s1",
            "value": "4A 73 63 72 69 70 74"
          },
          {
            "id": "ChinaChopperASPX_s2",
            "value": "25 3E 3C 25 65 76 61 6C 28 52 65 71 75 65 73 74 2E 49 74 65 6D 5B"
          },
          {
            "id": "ChinaChopperASPX_s3",
            "value": "75 6E 73 61 66 65"
          }
        ]
      }
    },
    "conditions": [
      {
        "sequence": {
          "group": "ChinaChopperASPX",
          "from": "ChinaChopperASPX_s0",
          "to": "ChinaChopperASPX_s1",
          "op": "ONE_WILDCARD"
        }
      },
      {
        "sequence": {
          "group": "ChinaChopperASPX",
          "from": "ChinaChopperASPX_s1",
          "to": "ChinaChopperASPX_s2",
          "op": "ONE_WILDCARD"
        }
      },
      {
        "sequence": {
          "group": "ChinaChopperASPX",
          "from": "ChinaChopperASPX_s2",
          "to": "ChinaChopperASPX_s3",
          "op": "RANGE_1_100"
        }
      },
      {
        "groups": [
          "ChinaChopperASPX"
        ],
        "operator": "and"
      }
    ]
  },
  "webshell_ChinaChopper_php": {
    "groups": {
      "ChinaChopperPHP": {
        "match_type": "cadena",
        "data_type": "hex",
        "strings": [
          {
            "id": "ChinaChopperPHP_s0",
            "value": "3C 3F 70 68 70 20 40 65 76 61 6C 28 24 5F 50 4F 53 54 5B"
          },
          {
            "id": "ChinaChopperPHP_s1",
            "value": "70 61 73 73 77 6F 72 64"
          },
          {
            "id": "ChinaChopperPHP_s2",
            "value": "5D 29 3B 3F 3E"
          }
        ]
      }
    },
    "conditions": [
      {
        "sequence": {
          "group": "ChinaChopperPHP",
          "from": "ChinaChopperPHP_s0",
          "to": "ChinaChopperPHP_s1",
          "op": "ONE_WILDCARD"
        }
      },
      {
        "sequence": {
          "group": "ChinaChopperPHP",
          "from": "ChinaChopperPHP_s1",
          "to": "ChinaChopperPHP_s2",
          "op": "ONE_WILDCARD"
        }
      },
      {
        "groups": [
          "ChinaChopperPHP"
        ],
        "operator": "and"
      }
    ]
  }
}